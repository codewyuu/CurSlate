"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[135,471],{203:(e,t,n)=>{var r=n(467),o=n(980),a=n(756),c=n.n(a);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var s={isActive:!0,autoStart:!1,translateOnHover:!0,keyboardShortcutActivation:!1,hoverDelay:300,targetLanguage:"en",autoDetectLanguage:!0,sourceLanguages:["en","es","fr","de","zh","ru"],translationProvider:"google",popupStyle:"minimal",popupPosition:"cursor",fontSize:"medium",showSourceLanguage:!0,activationKey:"none",useSystemNotifications:!1};function u(e){var t=e?{16:"icons/icon16.png",48:"icons/icon48.png",128:"icons/icon128.png"}:{16:"icons/icon16_disabled.png",48:"icons/icon48_disabled.png",128:"icons/icon128_disabled.png"};chrome.action.setIcon({path:t})}chrome.runtime.onInstalled.addListener((function(){chrome.storage.sync.get(Object.keys(s),(function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},s);for(var n in e)void 0!==e[n]&&(t[n]=e[n]);chrome.storage.sync.set(t,(function(){chrome.runtime.lastError?console.error("Failed to save initial settings:",chrome.runtime.lastError):(chrome.contextMenus.create({id:"translateSelection",title:'Translate "%s"',contexts:["selection"]}),u(t.isActive),chrome.tabs.query({},(function(e){e.forEach((function(e){chrome.tabs.sendMessage(e.id,{action:"toggleActive",isActive:t.isActive}).catch((function(){}))}))})))}))}))})),chrome.runtime.onMessage.addListener((function(e,t,n){return"translate"===e.action?(f(e.text,e.sourceLanguage,e.targetLanguage).then((function(e){return n(e)})).catch((function(e){return n({error:e.message})})),!0):"getSettings"===e.action?(chrome.storage.sync.get(null,(function(e){n(e)})),!0):"saveSettings"===e.action?(chrome.storage.sync.set(e.settings,(function(){void 0!==e.settings.isActive&&u(e.settings.isActive),n({success:!0})})),!0):"setActive"===e.action?(chrome.storage.sync.set({isActive:e.isActive},(function(){u(e.isActive),chrome.tabs.query({},(function(t){t.forEach((function(t){chrome.tabs.sendMessage(t.id,{action:"toggleActive",isActive:e.isActive}).catch((function(){}))}))})),n({success:!0}),chrome.storage.sync.get(["useSystemNotifications"],(function(t){t.useSystemNotifications&&chrome.notifications.create({type:"basic",iconUrl:"icons/icon128.png",title:"CurSlate",message:e.isActive?"Translation activated":"Translation deactivated"})}))})),!0):void 0})),chrome.contextMenus.onClicked.addListener((function(e,t){"translateSelection"===e.menuItemId&&chrome.storage.sync.get(["targetLanguage"],(function(n){f(e.selectionText,"auto",n.targetLanguage).then((function(n){chrome.tabs.sendMessage(t.id,{action:"showContextMenuTranslation",originalText:e.selectionText,translatedText:n.translatedText,sourceLanguage:n.detectedSourceLanguage||"auto"})})).catch((function(e){console.error("Translation error:",e)}))}))})),chrome.action.onClicked.addListener((function(){chrome.storage.sync.get(["isActive"],(function(e){var t=!e.isActive;chrome.storage.sync.set({isActive:t},(function(){u(t),chrome.tabs.query({},(function(e){e.forEach((function(e){chrome.tabs.sendMessage(e.id,{action:"toggleActive",isActive:t}).catch((function(){}))}))})),chrome.storage.sync.get(["useSystemNotifications"],(function(e){e.useSystemNotifications&&chrome.notifications.create({type:"basic",iconUrl:"icons/icon128.png",title:"CurSlate",message:t?"Translation activated":"Translation deactivated"})}))}))}))}));var g=n(969),l=0;function f(e,t,n){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(c().mark((function e(t,n,r){var o,a,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&""!==t.trim()){e.next=2;break}return e.abrupt("return",{error:"No text to translate"});case 2:if(o=Date.now(),!((a=o-l)<500)){e.next=7;break}return e.next=7,new Promise((function(e){return setTimeout(e,500-a)}));case 7:return l=Date.now(),e.prev=8,e.next=11,g(t,{from:"auto"===n?"auto":n,to:r});case 11:return(i=e.sent).translatedText&&p(t,i.translatedText,i.detectedSourceLanguage,r),e.abrupt("return",i);case 16:return e.prev=16,e.t0=e.catch(8),console.error("Translation error:",e.t0),e.abrupt("return",{error:e.t0.message||"Translation failed"});case 20:case"end":return e.stop()}}),e,null,[[8,16]])})))).apply(this,arguments)}function p(e,t,n,r){chrome.storage.local.get(["translationHistory"],(function(o){var a=o.translationHistory||[];a.unshift({originalText:e,translatedText:t,sourceLanguage:n,targetLanguage:r,timestamp:(new Date).toISOString()}),a.length>100&&(a=a.slice(0,100)),chrome.storage.local.set({translationHistory:a})}))}},969:(e,t,n)=>{n.r(t);var r=n(980),o=n(467),a=n(284),c=n(756),i=n.n(c);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e=n.hmd(e);var g={"zh-CN":"zh","zh-TW":"zh-TW",auto:"auto"},l=new Map,f=18e5,m=5e3;function p(e){return g[e]||e}function h(e,t){if(!e||"string"!=typeof e)throw new Error("Invalid text input: Text must be a non-empty string");if(e.length>m)throw new Error("Text exceeds maximum length of ".concat(m," characters"));if(!t||"object"!==(0,a.A)(t))throw new Error("Invalid options: Options must be an object");if(!t.to)throw new Error("Target language must be specified in options")}function d(e,t){var n=t.from||"auto",r=t.to;return"".concat(n,":").concat(r,":").concat(e)}function v(e){return!!e&&Date.now()-e.timestamp<f}function y(e){try{return ISO6391.getName(e)||e}catch(t){return e}}function b(e,t){var n=e.message||"Unknown error occurred";return console.error("Translation error:",{error:n,text:t.substring(0,100)+(t.length>100?"...":""),timestamp:(new Date).toISOString()}),"BAD_NETWORK"===e.code?new Error("Network error: Please check your internet connection"):"BAD_REQUEST"===e.code?new Error("Invalid request: Please check your input"):"RATE_LIMIT"===e.code?new Error("Rate limit exceeded: Please try again later"):new Error("Translation failed: ".concat(n))}function w(){return w=(0,o.A)(i().mark((function e(t){var n,r,o,a,c,s,g,f,m=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.length>1&&void 0!==m[1]?m[1]:{},e.prev=1,h(t,n),r=u(u({},n),{},{from:p(n.from||"auto"),to:p(n.to)}),o=d(t,r),!v(a=l.get(o))){e.next=8;break}return e.abrupt("return",a.result);case 8:return c=new URLSearchParams({q:t,target:r.to,source:"auto"!==r.from?r.from:void 0}),e.next=11,fetch("".concat("https://translation.googleapis.com/language/translate/v2","?").concat(c.toString()),{method:"GET",headers:{"Content-Type":"application/json"}});case 11:if((s=e.sent).ok){e.next=14;break}throw new Error("Translation request failed: ".concat(s.statusText));case 14:return e.next=16,s.json();case 16:return g=e.sent,f={translatedText:g.data.translations[0].translatedText,detectedSourceLanguage:g.data.translations[0].detectedSourceLanguage||r.from,sourceLanguageName:y(g.data.translations[0].detectedSourceLanguage||r.from),targetLanguageName:y(r.to),confidence:1,alternativeTranslations:[],originalText:t},l.set(o,{result:f,timestamp:Date.now()}),e.abrupt("return",f);case 22:throw e.prev=22,e.t0=e.catch(1),b(e.t0,t);case 25:case"end":return e.stop()}}),e,null,[[1,22]])}))),w.apply(this,arguments)}e.exports={translateText:function(e){return w.apply(this,arguments)},normalizeLanguageCode:p,getLanguageName:y,MAX_TEXT_LENGTH:m,CACHE_EXPIRY:f}}},e=>{e.O(0,[363],(()=>e(e.s=203))),e.O()}]);