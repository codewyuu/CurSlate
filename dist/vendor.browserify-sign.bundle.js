"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9515],{20:(r,a,t)=>{var e=t(92861).Buffer,s=t(47108),n=t(28399),i=t(56698),h=t(35359),o=t(74847),d=t(62951);function g(r){n.Writable.call(this);var a=d[r];if(!a)throw new Error("Unknown message digest");this._hashType=a.hash,this._hash=s(a.hash),this._tag=a.id,this._signType=a.sign}function p(r){n.Writable.call(this);var a=d[r];if(!a)throw new Error("Unknown message digest");this._hash=s(a.hash),this._tag=a.id,this._signType=a.sign}function u(r){return new g(r)}function c(r){return new p(r)}Object.keys(d).forEach((function(r){d[r].id=e.from(d[r].id,"hex"),d[r.toLowerCase()]=d[r]})),i(g,n.Writable),g.prototype._write=function(r,a,t){this._hash.update(r),t()},g.prototype.update=function(r,a){return this._hash.update("string"==typeof r?e.from(r,a):r),this},g.prototype.sign=function(r,a){this.end();var t=this._hash.digest(),e=h(t,r,this._hashType,this._signType,this._tag);return a?e.toString(a):e},i(p,n.Writable),p.prototype._write=function(r,a,t){this._hash.update(r),t()},p.prototype.update=function(r,a){return this._hash.update("string"==typeof r?e.from(r,a):r),this},p.prototype.verify=function(r,a,t){var s="string"==typeof a?e.from(a,t):a;this.end();var n=this._hash.digest();return o(s,n,r,this._signType,this._tag)},r.exports={Sign:u,Verify:c,createSign:u,createVerify:c}},35359:(r,a,t)=>{var e=t(92861).Buffer,s=t(83507),n=t(67332),i=t(86729).ec,h=t(39404),o=t(78170),d=t(64589);function g(r,a,t,n){if((r=e.from(r.toArray())).length<a.byteLength()){var i=e.alloc(a.byteLength()-r.length);r=e.concat([i,r])}var h=t.length,o=function(r,a){r=(r=p(r,a)).mod(a);var t=e.from(r.toArray());if(t.length<a.byteLength()){var s=e.alloc(a.byteLength()-t.length);t=e.concat([s,t])}return t}(t,a),d=e.alloc(h);d.fill(1);var g=e.alloc(h);return g=s(n,g).update(d).update(e.from([0])).update(r).update(o).digest(),d=s(n,g).update(d).digest(),{k:g=s(n,g).update(d).update(e.from([1])).update(r).update(o).digest(),v:d=s(n,g).update(d).digest()}}function p(r,a){var t=new h(r),e=(r.length<<3)-a.bitLength();return e>0&&t.ishrn(e),t}function u(r,a,t){var n,i;do{for(n=e.alloc(0);8*n.length<r.bitLength();)a.v=s(t,a.k).update(a.v).digest(),n=e.concat([n,a.v]);i=p(n,r),a.k=s(t,a.k).update(a.v).update(e.from([0])).digest(),a.v=s(t,a.k).update(a.v).digest()}while(-1!==i.cmp(r));return i}function c(r,a,t,e){return r.toRed(h.mont(t)).redPow(a).fromRed().mod(e)}r.exports=function(r,a,t,s,f){var l=o(a);if(l.curve){if("ecdsa"!==s&&"ecdsa/rsa"!==s)throw new Error("wrong private key type");return function(r,a){var t=d[a.curve.join(".")];if(!t)throw new Error("unknown curve "+a.curve.join("."));var s=new i(t).keyFromPrivate(a.privateKey).sign(r);return e.from(s.toDER())}(r,l)}if("dsa"===l.type){if("dsa"!==s)throw new Error("wrong private key type");return function(r,a,t){for(var s,n=a.params.priv_key,i=a.params.p,o=a.params.q,d=a.params.g,f=new h(0),l=p(r,o).mod(o),m=!1,v=g(n,o,r,t);!1===m;)f=c(d,s=u(o,v,t),i,o),0===(m=s.invm(o).imul(l.add(n.mul(f))).mod(o)).cmpn(0)&&(m=!1,f=new h(0));return function(r,a){r=r.toArray(),a=a.toArray(),128&r[0]&&(r=[0].concat(r)),128&a[0]&&(a=[0].concat(a));var t=[48,r.length+a.length+4,2,r.length];return t=t.concat(r,[2,a.length],a),e.from(t)}(f,m)}(r,l,t)}if("rsa"!==s&&"ecdsa/rsa"!==s)throw new Error("wrong private key type");if(void 0!==a.padding&&1!==a.padding)throw new Error("illegal or unsupported padding mode");r=e.concat([f,r]);for(var m=l.modulus.byteLength(),v=[0,1];r.length+v.length+1<m;)v.push(255);v.push(0);for(var y=-1;++y<r.length;)v.push(r[y]);return n(v,l)},r.exports.getKey=g,r.exports.makeKey=u},55715:(r,a,t)=>{r.exports=t(62951)},62951:r=>{r.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},64589:r=>{r.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},74847:(r,a,t)=>{var e=t(92861).Buffer,s=t(39404),n=t(86729).ec,i=t(78170),h=t(64589);function o(r,a){if(r.cmpn(0)<=0)throw new Error("invalid sig");if(r.cmp(a)>=0)throw new Error("invalid sig")}r.exports=function(r,a,t,d,g){var p=i(t);if("ec"===p.type){if("ecdsa"!==d&&"ecdsa/rsa"!==d)throw new Error("wrong public key type");return function(r,a,t){var e=h[t.data.algorithm.curve.join(".")];if(!e)throw new Error("unknown curve "+t.data.algorithm.curve.join("."));var s=new n(e),i=t.data.subjectPrivateKey.data;return s.verify(a,r,i)}(r,a,p)}if("dsa"===p.type){if("dsa"!==d)throw new Error("wrong public key type");return function(r,a,t){var e=t.data.p,n=t.data.q,h=t.data.g,d=t.data.pub_key,g=i.signature.decode(r,"der"),p=g.s,u=g.r;o(p,n),o(u,n);var c=s.mont(e),f=p.invm(n);return 0===h.toRed(c).redPow(new s(a).mul(f).mod(n)).fromRed().mul(d.toRed(c).redPow(u.mul(f).mod(n)).fromRed()).mod(e).mod(n).cmp(u)}(r,a,p)}if("rsa"!==d&&"ecdsa/rsa"!==d)throw new Error("wrong public key type");a=e.concat([g,a]);for(var u=p.modulus.byteLength(),c=[1],f=0;a.length+c.length+2<u;)c.push(255),f+=1;c.push(0);for(var l=-1;++l<a.length;)c.push(a[l]);c=e.from(c);var m=s.mont(p.modulus);r=(r=new s(r).toRed(m)).redPow(new s(p.publicExponent)),r=e.from(r.fromRed().toArray());var v=f<8?1:0;for(u=Math.min(r.length,c.length),r.length!==c.length&&(v=1),l=-1;++l<u;)v|=r[l]^c[l];return 0===v}}}]);